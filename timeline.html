<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            text-align: center;
            background-color: #f9f9f9;
        }
        nav {
            background-color: #333;
            padding: 10px 0;
            display: flex;
            justify-content: center;
            width: 100%;
        }
        nav a {
            color: #fff;
            padding: 10px 20px;
            text-decoration: none;
            font-weight: bold;
        }
        nav a.active {
            background-color: #555;
            border-radius: 5px;
        }
        .content {
            max-width: 900px;
            margin: 40px auto;
            background: #fff;
            padding: 40px 20px;
            border-radius: 10px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
        }
        #inputBox {
            width: 100%;
            height: 150px;
        }
        #timeline {
            margin-top: 30px;
            width: 100%;
            position: relative;
            height: 60px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .segment {
            position: absolute;
            top: 0;
            height: 100%;
        }
        .free { background-color: #7ed957; }
        .busy { background-color: #ff5757; }
        .override { background-color: yellow !important; }
            .hour-marker {
            position: absolute;
            top: 0;
            width: 1px;
            height: 100%;
            background: #0003;
        }
        .hour-label {
            position: absolute;
            top: -20px;
            font-size: 12px;
            transform: translateX(-50%);
        }
</style>
</head>
<body>

<nav>
    <a class="active">Timeline</a>
</nav>

<div class="content">
    <h2>Call Timeline Visualizer</h2>
    <p>Paste your raw time list below:</p>
    <textarea id="inputBox"></textarea>
    <br><br>
    <button onclick="drawTimeline()">Parse & Draw</button>

    <div id="timeline"></div>
</div>

<script>
function parseTime(t) {
    let [time, ampm] = t.split(" ");
    let [h, m] = time.split(":").map(Number);
    if (ampm === "PM" && h !== 12) h += 12;
    if (ampm === "AM" && h === 12) h = 0;
    return h * 60 + m;
}

function drawTimeline() {
    const raw = document.getElementById("inputBox").value.trim().split("
");
    const timeline = document.getElementById("timeline");
    timeline.innerHTML = "";

    const start = 8 * 60;
    const end = 17 * 60 + 30;
    const total = end - start;

    let calls = raw.map(line => {
        let parts = line.split("	");
        if (parts.length !== 2) return null;
        return {
            from: parseTime(parts[0]),
            to: parseTime(parts[1])
        };
    }).filter(x => x);

    calls.forEach(c => {
        let div = document.createElement("div");
        div.className = "segment busy";
        div.style.left = ((c.from - start) / total) * 100 + "%";
        div.style.width = ((c.to - c.from) / total) * 100 + "%";
        timeline.appendChild(div);
    });

    let freeSegments = [];
    let last = start;

    calls.forEach(c => {
        if (c.from > last) {
            freeSegments.push({ from: last, to: c.from });
        }
        last = c.to;
    });
    if (last < end) freeSegments.push({ from: last, to: end });

    freeSegments.forEach(c => {
        let div = document.createElement("div");
        div.className = "segment free";
        div.style.left = ((c.from - start) / total) * 100 + "%";
        div.style.width = ((c.to - c.from) / total) * 100 + "%";
        timeline.appendChild(div);
    });

    // Yellow override tool
    let selecting = false;
    let startX = 0;
    const yellow = document.createElement("div");
    yellow.className = "segment override";
    yellow.style.display = "none";
    timeline.appendChild(yellow);

    timeline.onmousedown = e => {
        selecting = true;
        startX = e.offsetX;
        yellow.style.left = (startX / timeline.clientWidth) * 100 + "%";
        yellow.style.width = "0%";
        yellow.style.display = "block";
    };

    timeline.onmousemove = e => {
        if (!selecting) return;
        const curr = e.offsetX;
        const width = curr - startX;
        yellow.style.width = (width / timeline.clientWidth) * 100 + "%";
    };

    timeline.onmouseup = () => selecting = false;

    // Hour markers
    for (let h = 8; h <= 17; h++) {
        const pos = ((h * 60 - start) / total) * 100;
        const m = document.createElement("div");
        m.className = "hour-marker";
        m.style.left = pos + "%";
        const label = document.createElement("div");
        label.className = "hour-label";
        label.style.left = pos + "%";
        label.textContent = h + ":00";
        timeline.appendChild(m);
        timeline.appendChild(label);
    );("click", e => {
        const override = document.createElement("div");
        override.className = "segment override";
        override.style.left = ((e.offsetX / timeline.clientWidth) * 100) + "%";
        override.style.width = "5%";
        timeline.appendChild(override);
    });
}
</script>

</body>
</html>
